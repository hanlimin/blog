---
---

# 测试

任何软件应用程序都应通过功能测试和非功能测试，以确保它满足业务需求和性能标准。 功能测试涵盖白盒测试、单元测试和黑盒测试的主要功能。 非功能测试或性能测试侧重于速度、稳定性、 可扩展性、可靠性、负载容量和压力之下的性能。 

## 性能指标

### 响应时间

RT（Response Time）指用户从客户端发起一个请求开始，到客户端接收到从服务器端返回的响应结束，整个过程所耗费的时间。在性能检测中一般以压力发起端至被压测服务器返回处理结果的时间为计量，单位一般为秒或毫秒。平均响应时间指系统稳定运行时间段内，同一请求的平均响应时间。

参考标准：
不同行业不同业务可接受的响应时间是不同的，一般情况，对于在线实时交易：
- 互联网企业：500毫秒以下。
- 金融企业：1秒以下为佳，部分复杂业务3秒以下。
- 保险企业：3秒以下为佳。
- 制造业：5秒以下为佳

### 处理能力

系统处理能力是指系统在利用系统硬件平台和软件平台进行信息处理的能力。 系统处理能力通过系统每秒钟能够处理的请求数量来评价，请求有两种理解：一是业务人员角度的一笔业务过程；二是系统角度的一次请求接收和响应过程。前者称为业务过程，后者称为事务。两种交易指标都可以评价应用系统的处理能力。一般的建议与系统请求日志保持一致，以便于统计业务量或者请求量。系统处理能力指标是技术测试活动中重要指标。

可用以下指标来度量：
- HPS（Hits Per Second） ：每秒点击次数，单位是次/秒。
- TPS（Transaction per Second）：系统每秒处理交易数，单位是笔/秒。
- QPS（Query per Second）：系统每秒处理查询次数，单位是次/秒。 对于互联网业务中，如果某些业务有且仅有一个请求连接，那么TPS=QPS=HPS，一般情况下用TPS来衡量整个业务流程，用QPS来衡量接口查询次数，用HPS来表示对服务器单击请求。

无论TPS、QPS、HPS，此指标是衡量系统处理能力非常重要的指标，越大越好，根据经验，一般情况下：

金融行业：1000 TPS~50000 TPS，不包括互联网化的活动。
保险行业：100 TPS~100000 TPS，不包括互联网化的活动。
制造行业：10 TPS~5000 TPS。
互联网电子商务：10000 TPS~1000000 TPS。
互联网中型网站：1000 TPS~50000 TPS。
互联网小型网站：500 TPS~10000 TPS

### 并发用户

并发用户数指在同一时刻内，登录系统并进行业务操作的用户数量。 并发用户数对于长连接系统来说最大并发用户数即是系统的并发接入能力。对于短连接系统而言最大并发用户数并不等于系统的并发接入能力，而是与系统架构、系统处理能力等各种情况相关。例如系统吞吐能力很强，加上短连接一般都有连接复用，往往并发用户数大于系统的并发接入连接数。所以对于大部分短连接类型的系统，吞吐量模式（RPS模式，Request Per Second）比较适合。

### 错误率

错误率指系统在负载情况下，失败交易的概率。错误率＝（失败交易数/交易总数）×100%。稳定性较好的系统，其错误率应该由超时引起，即为超时率。

## 资源指标

### CPU

中央处理器是一块超大规模的集成电路，是一台计算机的运算核心（Core）和控制核心（ Control Unit）。它的功能主要是解释计算机指令以及处理计算机软件中的数据。CPU Load：系统正在干活的多少的度量，队列长度。系统平均负载。

参考标准：
CPU指标主要指的CPU使用率、利用率，包括用户态（user）、系统态（sys）、等待态（wait）、空闲态（idle）。CPU使用率、利用率要低于业界警戒值范围之内，即小于或者等于75%、CPU sys%小于或者等于30%，CPU wait%小于或者等于5%。单核CPU也需遵循上述指标要求。CPU Load要小于CPU核数。

### Memory

内存是计算机中重要的部件之一，它是与CPU进行沟通的桥梁。计算机中所有程序的运行都是在内存中进行的，因此内存的性能对计算机的影响非常大。

参考标准：
现代的操作系统为了最大利用内存，在内存中存放了缓存，因此内存利用率100%并不代表内存有瓶颈，衡量系统内有有瓶颈主要靠SWAP（与虚拟内存交换）交换空间利用率，一般情况下，SWAP交换空间利用率要低于70%，太多的交换将会引起系统性能低下。

### 磁盘吞吐量
磁盘吞吐量是指在无磁盘故障的情况下单位时间内通过磁盘的数据量。

参考标准：
磁盘指标主要有每秒读写多少兆，磁盘繁忙率，磁盘队列数，平均服务时间，平均等待时间，空间利用率。其中磁盘繁忙率是直接反映磁盘是否有瓶颈的重要依据，一般情况下，磁盘繁忙率要低于70%。

### 网络吞吐量

网络吞吐量是指在无网络故障的情况下单位时间内通过的网络的数据数量。单位为Byte/s。网络吞吐量指标用于衡量系统对于网络设备或链路传输能力的需求。当网络吞吐量指标接近网络设备或链路最大传输能力时，则需要考虑升级网络设备。

参考标准：
网络吞吐量指标主要有每秒有多少兆流量进出，一般情况下不能超过设备或链路最大传输能力的70%。

## 内核参数

- Maxuprc
  限制每个用户的用户进程的最大数量
- Max_thread_proc
  定义每个进程允许的最大线程数量
- Filecache_max	
  最大可用于cache file I/O的物理内存
- Ninode
  内存中HFS文件系统打开i节点的最大数量
- Nkthread
  限制允许同时运行的线程数量
- Nproc
  限制允许同时运行的进程数量
- Nstrpty
  基于STREAMS的伪终端 （pts） 的最大数量
- Maxdsiz
  任何用户进程的数据段的最大大小（以字节为单位）
- maxdsiz_64bit
  任何用户进程的数据段的最大大小（以字节为单位）
- maxfiles_lim
  每个进程的文件描述符的最大数目硬限制
- maxssiz_64bit
  任何用户进程的堆栈的最大大小
- Maxtsiz
  任一用户进程的文本段的最大大小
- nflocks
  文件锁的最大数量
- maxtsiz_64bit
  任一用户进程的文本段的最大大小
- msgmni
  系统级System V IPC消息队列 （ID) 所允许的最大数量
- msgtql
  系统中任意时间的最大System V IPC消息数
- npty
  BSD伪终端 （pty） 的最大数量
- nstrtel
  指定内核可支持传入telnet会话的telnet设备文件的数量
- nswapdev
  可用于交换的设备的最大数量
- nswapfs
  可用于交换的文件系统的最大数量
- semmni
  System V IPC系统级信号量标识符的数量
- semmns
  System V系统级信号量的数量
- shmmax
  System V共享内存段的最大大小
- shmmni
  系统中System V共享内存段标识符的数量
- shmseg
  每个进程System V共享内存段的最大数量

## 中间件指标

### GC

- GC频率
  Java虚拟机垃圾部分回收频率，每秒多少次
- Full GC频率
  Java虚拟机垃圾完全回收频率，每小时多少次
- Full GC平均时长
  用于垃圾完全回收的平均时长，秒
- Full GC最大时长	
  用于垃圾完全回收的最大时长，秒
- 堆使用率
  堆使用率，百分比

### ThreadPool

- ThreadPool
  活动的线程数
- Pending User Request
  处于排队的用户请求个数

### JDBC

- JDBC Active Connection
  JDBC活动连接数

## 数据库指标

常用的数据库例如ＭySQL指标主要包括SQL、吞吐量、缓存命中率、连接数等，具体如下：

### SQL

  执行SQL耗时，微秒

### 吞吐量	

- QPS
  每秒查询次数
- TPS
  每秒事务次数

### 命中率

- Key Buffer命中率	
  索引缓冲区命中率
- InnoDB Buffer命中率
InnoDB缓冲区命中率
- Query Cache命中率	
查询缓存命中率
- Table Cache命中率
表缓存命中率
- Thread Cache命中率
线程缓存命中率

### 锁

- 等待次数
锁等待次数
- 等待时间
锁等待时间，微秒

## 前端指标

### 页面展示

- 首次显示时间
在浏览器地址栏输入URL按回车到用户看到网页的第一个视觉标志为止，毫秒。
- OnLoad事件时间
浏览器触发onLoad事件的时间，当原始文档和所有引用的内容完全下载后才会触发这个事件，毫秒。
- 完全载入的时间
所有onLoad JavaScript处理程序执行完毕，所有动态的或延迟加载的内容都通过这些处理程序触发的时间，毫秒。

### 页面数量

- 页面大小
整个页面大小，KB。
- 请求数量
从网站下载资源时所有网络请求的总数，尽量少。

### 网络

- DNS时间
DNS查找时间，毫秒。
- 连接时间
连接时间就是浏览器与Web服务器建立TCP/IP连接的时间，毫秒。
- 服务器时间
服务器处理时间，毫秒。
- 传输时间
内容传输所用时间，毫秒。
- 等待时间
等待某个资源释放的时间，毫秒。
